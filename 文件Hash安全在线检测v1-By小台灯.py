ZnJvbSBzZWxlbml1bSBpbXBvcnQgd2ViZHJpdmVyDQpmcm9tIHNlbGVuaXVtLndlYmRyaXZlci5jaHJvbWUuc2VydmljZSBpbXBvcnQgU2VydmljZQ0KZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY29tbW9uLmJ5IGltcG9ydCBCeQ0KZnJvbSBzZWxlbml1bS53ZWJkcml2ZXIuY29tbW9uLmtleXMgaW1wb3J0IEtleXMNCmZyb20gc2VsZW5pdW0ud2ViZHJpdmVyLnN1cHBvcnQudWkgaW1wb3J0IFdlYkRyaXZlcldhaXQNCmZyb20gc2VsZW5pdW0ud2ViZHJpdmVyLnN1cHBvcnQgaW1wb3J0IGV4cGVjdGVkX2NvbmRpdGlvbnMgYXMgRUMNCmltcG9ydCB0a2ludGVyIGFzIHRrDQpmcm9tIHRraW50ZXIgaW1wb3J0IG1lc3NhZ2Vib3gNCmltcG9ydCB0aW1lDQoNCmRlZiBnZXRfc2NyZWVuX2RpbWVuc2lvbnMod2luZG93KToNCiAgICAjIEZ1bmN0aW9uIHRvIGdldCB0aGUgc2NyZWVuIHdpZHRoIGFuZCBoZWlnaHQNCiAgICBzY3JlZW5fd2lkdGggPSB3aW5kb3cud2luZm9fc2NyZWVud2lkdGgoKQ0KICAgIHNjcmVlbl9oZWlnaHQgPSB3aW5kb3cud2luZm9fc2NyZWVuaGVpZ2h0KCkNCiAgICByZXR1cm4gc2NyZWVuX3dpZHRoLCBzY3JlZW5faGVpZ2h0DQoNCmRlZiBjZW50ZXJfd2luZG93KHdpbmRvdywgd2lkdGgsIGhlaWdodCk6DQogICAgIyBGdW5jdGlvbiB0byBjZW50ZXIgdGhlIHdpbmRvdyBvbiB0aGUgc2NyZWVuDQogICAgc2NyZWVuX3dpZHRoLCBzY3JlZW5faGVpZ2h0ID0gZ2V0X3NjcmVlbl9kaW1lbnNpb25zKHdpbmRvdykNCiAgICB4X2Nvb3JkaW5hdGUgPSBpbnQoKHNjcmVlbl93aWR0aCAvIDIpIC0gKHdpZHRoIC8gMikpDQogICAgeV9jb29yZGluYXRlID0gaW50KChzY3JlZW5faGVpZ2h0IC8gMikgLSAoaGVpZ2h0IC8gMikpDQogICAgd2luZG93Lmdlb21ldHJ5KGYne3dpZHRofXh7aGVpZ2h0fSt7eF9jb29yZGluYXRlfSt7eV9jb29yZGluYXRlfScpDQoNCmRlZiBzdGFydF9icm93c2VyKCk6DQogICAgIyBGdW5jdGlvbiB0byBzdGFydCB0aGUgQ2hyb21lIGJyb3dzZXINCiAgICBnbG9iYWwgZHJpdmVyDQogICAgZHJpdmVyID0gd2ViZHJpdmVyLkNocm9tZShzZXJ2aWNlPXNlcnZpY2UpDQoNCmRlZiBjbG9zZV9leGlzdGluZ193aW5kb3dzKCk6DQogICAgIyBDbG9zZSBhbGwgZXhpc3Rpbmcgd2luZG93cyBleGNlcHQgdGhlIG9yaWdpbmFsIG9uZQ0KICAgIGhhbmRsZXMgPSBkcml2ZXIud2luZG93X2hhbmRsZXMNCiAgICB3aGlsZSBsZW4oaGFuZGxlcykgPiAxOg0KICAgICAgICBkcml2ZXIuc3dpdGNoX3RvLndpbmRvdyhoYW5kbGVzWy0xXSkNCiAgICAgICAgZHJpdmVyLmNsb3NlKCkNCiAgICAgICAgaGFuZGxlcyA9IGRyaXZlci53aW5kb3dfaGFuZGxlcw0KICAgIGRyaXZlci5zd2l0Y2hfdG8ud2luZG93KGhhbmRsZXNbMF0pICAjIFN3aXRjaCBiYWNrIHRvIHRoZSBvcmlnaW5hbCB3aW5kb3cNCg0KZGVmIHNlYXJjaCgpOg0KICAgIHNlYXJjaF9xdWVyaWVzID0gZW50cnkuZ2V0KCIxLjAiLCB0ay5FTkQpLnN0cmlwKCkuc3BsaXQoIlxuIikNCiAgICBzZWFyY2hfcXVlcmllcyA9IFtxdWVyeS5zdHJpcCgpIGZvciBxdWVyeSBpbiBzZWFyY2hfcXVlcmllcyBpZiBxdWVyeS5zdHJpcCgpXQ0KICAgIGlmIG5vdCBzZWFyY2hfcXVlcmllczoNCiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIumUmeivryIsICLor7flhYjovpPlhaXmlofku7ZIYXNo77yM54K55Ye75Y+v6YCJ6aG55ZCO5YaN5pCc57Si44CCIikNCiAgICAgICAgcmV0dXJuDQoNCiAgICBzZWxlY3RlZF9lbmdpbmVzID0gW2kgZm9yIGksIHZhciBpbiBlbnVtZXJhdGUob3B0aW9uX3ZhcnMpIGlmIHZhci5nZXQoKSA9PSAxXQ0KDQogICAgaWYgbm90IHNlbGVjdGVkX2VuZ2luZXM6DQogICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCLplJnor68iLCAi6K+36YCJ5oup6Iez5bCR5LiA5Liq5p+l6K+i5byV5pOOIikNCiAgICAgICAgcmV0dXJuDQoNCiAgICBnbG9iYWwgZHJpdmVyDQogICAgdHJ5Og0KICAgICAgICAjIENoZWNrIGlmIHRoZSBkcml2ZXIgaXMgYWxyZWFkeSBjbG9zZWQgYW5kIHJlc3RhcnQgaWYgbmVjZXNzYXJ5DQogICAgICAgIGRyaXZlci50aXRsZQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgc3RhcnRfYnJvd3NlcigpDQoNCiAgICBjbG9zZV9leGlzdGluZ193aW5kb3dzKCkgICMgQ2xvc2UgZXhpc3Rpbmcgd2luZG93cyBiZWZvcmUgb3BlbmluZyBuZXcgb25lcw0KDQogICAgZm9yIHF1ZXJ5IGluIHNlYXJjaF9xdWVyaWVzOg0KICAgICAgICBmb3IgaSBpbiBzZWxlY3RlZF9lbmdpbmVzOg0KICAgICAgICAgICAgdHJ5Og0KICAgICAgICAgICAgICAgIGlmIGkgPT0gMDogICMg5b6u5q2lDQogICAgICAgICAgICAgICAgICAgIGRyaXZlci5leGVjdXRlX3NjcmlwdCgid2luZG93Lm9wZW4oJycpOyIpDQogICAgICAgICAgICAgICAgICAgIGRyaXZlci5zd2l0Y2hfdG8ud2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1stMV0pDQogICAgICAgICAgICAgICAgICAgIGRyaXZlci5nZXQoJ2h0dHBzOi8vcy50aHJlYXRib29rLmNvbS8nKQ0KICAgICAgICAgICAgICAgICAgICBzZWFyY2hfYm94ID0gV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5wcmVzZW5jZV9vZl9lbGVtZW50X2xvY2F0ZWQoKEJ5LlhQQVRILCAnLy8qW0BpZD0ic2VhcmNoV3JhcHBlciJdL2RpdlsxXS9kaXZbMV0vaW5wdXQnKSkpDQogICAgICAgICAgICAgICAgICAgIHNlYXJjaF9ib3guc2VuZF9rZXlzKHF1ZXJ5KQ0KICAgICAgICAgICAgICAgICAgICBzZWFyY2hfYm94LnNlbmRfa2V5cyhLZXlzLlJFVFVSTikNCiAgICAgICAgICAgICAgICBlbGlmIGkgPT0gMTogICMgVmlydXNUb3RhbA0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZXhlY3V0ZV9zY3JpcHQoIndpbmRvdy5vcGVuKCcnKTsiKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuc3dpdGNoX3RvLndpbmRvdyhkcml2ZXIud2luZG93X2hhbmRsZXNbLTFdKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KGYnaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUve3F1ZXJ5fScpDQogICAgICAgICAgICAgICAgICAgICMgZHJpdmVyLmdldCgnaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2hvbWUvc2VhcmNoJykNCiAgICAgICAgICAgICAgICAgICAgIyBzZWFyY2hfYm94ID0gV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5wcmVzZW5jZV9vZl9lbGVtZW50X2xvY2F0ZWQoKEJ5LlhQQVRILCAnLy8qW0BpZD0ic2VhcmNoSW5wdXQiXScpKSkNCiAgICAgICAgICAgICAgICBlbGlmIGkgPT0gMjogICMgVmlyU2Nhbg0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZXhlY3V0ZV9zY3JpcHQoIndpbmRvdy5vcGVuKCcnKTsiKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuc3dpdGNoX3RvLndpbmRvdyhkcml2ZXIud2luZG93X2hhbmRsZXNbLTFdKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KCdodHRwczovL3d3dy52aXJzY2FuLm9yZy8nKQ0KICAgICAgICAgICAgICAgICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwgJy8vKltAaWQ9ImxheW91dCJdL21haW4vZGl2L2RpdlsyXS9kaXZbMV0vZGl2WzJdJykpKS5jbGljaygpDQogICAgICAgICAgICAgICAgICAgIHNlYXJjaF9ib3ggPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLnByZXNlbmNlX29mX2VsZW1lbnRfbG9jYXRlZCgoQnkuWFBBVEgsICcvLypbQGlkPSJsYXlvdXQiXS9tYWluL2Rpdi9kaXZbMl0vZGl2WzJdL2Rpdi9kaXZbMl0vZGl2WzFdL2lucHV0JykpKQ0KICAgICAgICAgICAgICAgICAgICBzZWFyY2hfYm94LnNlbmRfa2V5cyhxdWVyeSkNCiAgICAgICAgICAgICAgICAgICAgc2VhcmNoX2JveC5zZW5kX2tleXMoS2V5cy5SRVRVUk4pDQogICAgICAgICAgICAgICAgIyBlbGlmIGkgPT0gMzogICMgMzYwDQogICAgICAgICAgICAgICAgIyAgICAgZHJpdmVyLmV4ZWN1dGVfc2NyaXB0KCJ3aW5kb3cub3BlbignJyk7IikNCiAgICAgICAgICAgICAgICAjICAgICBkcml2ZXIuc3dpdGNoX3RvLndpbmRvdyhkcml2ZXIud2luZG93X2hhbmRsZXNbLTFdKQ0KICAgICAgICAgICAgICAgICMgICAgIGRyaXZlci5nZXQoJ2h0dHBzOi8vdGkuMzYwLm5ldC8nKQ0KICAgICAgICAgICAgICAgICMgICAgIHNlYXJjaF9ib3ggPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLnByZXNlbmNlX29mX2VsZW1lbnRfbG9jYXRlZCgoQnkuWFBBVEgsICcvLypbQGlkPSJwYW5lLWFsbCJdL2Rpdi9pbnB1dCcpKSkNCiAgICAgICAgICAgICAgICAjICAgICBzZWFyY2hfYm94LnNlbmRfa2V5cyhxdWVyeSkNCiAgICAgICAgICAgICAgICAjICAgICB0aW1lLnNsZWVwKDUpDQogICAgICAgICAgICAgICAgIyAgICAgc2VhcmNoX2JveC5zZW5kX2tleXMoS2V5cy5SRVRVUk4pDQogICAgICAgICAgICAgICAgZWxpZiBpID09IDM6ICAjIOiFvuiurw0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZXhlY3V0ZV9zY3JpcHQoIndpbmRvdy5vcGVuKCcnKTsiKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuc3dpdGNoX3RvLndpbmRvdyhkcml2ZXIud2luZG93X2hhbmRsZXNbLTFdKQ0KICAgICAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KCdodHRwczovL2hhYm8ucXEuY29tLycpDQogICAgICAgICAgICAgICAgICAgIHNlYXJjaF9ib3ggPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLnByZXNlbmNlX29mX2VsZW1lbnRfbG9jYXRlZCgoQnkuWFBBVEgsICcvLypbQGlkPSJoZWFkZXJfaGFzaCJdJykpKQ0KICAgICAgICAgICAgICAgICAgICBzZWFyY2hfYm94LnNlbmRfa2V5cyhxdWVyeSkNCiAgICAgICAgICAgICAgICAgICAgc2VhcmNoX2JveC5zZW5kX2tleXMoS2V5cy5SRVRVUk4pDQogICAgICAgICAgICAgICAgIyBzZWFyY2hfYm94LnNlbmRfa2V5cyhxdWVyeSkNCiAgICAgICAgICAgICAgICAjIHNlYXJjaF9ib3guc2VuZF9rZXlzKEtleXMuUkVUVVJOKQ0KICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOg0KICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2Vycm9yKCLplJnor68iLCBmIuaXoOazleWcqOWogeiDgeaDheaKpeaQnOe0ouW8leaTjiB7b3B0aW9uc1tpXX0g5Lit5pCc57SiOiB7c3RyKGUpfSIpDQoNCmRlZiBvbl9jbG9zaW5nKCk6DQogICAgdHJ5Og0KICAgICAgICBkcml2ZXIucXVpdCgpDQogICAgZXhjZXB0Og0KICAgICAgICBwYXNzDQogICAgcm9vdC5kZXN0cm95KCkNCg0KIyDliJvlu7rkuIDkuKpDaHJvbWXmnI3liqENCmNocm9tZV9kcml2ZXJfcGF0aCA9ICIuL2Nocm9tZWRyaXZlci5leGUiDQpzZXJ2aWNlID0gU2VydmljZShleGVjdXRhYmxlX3BhdGg9Y2hyb21lX2RyaXZlcl9wYXRoKQ0KDQojIOWQr+WKqOa1j+iniOWZqOWunuS+iw0Kc3RhcnRfYnJvd3NlcigpDQoNCiMg5Yib5bu6dGtpbnRlcueql+WPow0Kcm9vdCA9IHRrLlRrKCkNCnJvb3QudGl0bGUoIuaWh+S7tkhhc2jlronlhajlnKjnur/mo4DmtYt2MS1CeeWwj+WPsOeBryIpDQpyb290Lmdlb21ldHJ5KCI4MDB4NTAwIikgICMg6K6+572u56qX5Y+j5aSn5bCPDQoNCiMg5bGF5Lit56qX5Y+jDQpjZW50ZXJfd2luZG93KHJvb3QsIDgwMCwgNTAwKQ0KDQoj57uZSVDovpPlhaXmoYbliJvlu7rlpI3liLbjgIHnspjotLTjgIHliarotLTlj7PplK7oj5zljZUNCmRlZiBjcmVhdGVfY29udGV4dF9tZW51KHdpZGdldCk6DQogICAgbWVudSA9IHRrLk1lbnUod2lkZ2V0LCB0ZWFyb2ZmPTApDQogICAgbWVudS5hZGRfY29tbWFuZChsYWJlbD0i5aSN5Yi2IiwgY29tbWFuZD1sYW1iZGE6IHdpZGdldC5ldmVudF9nZW5lcmF0ZSgnPDxDb3B5Pj4nKSkNCiAgICBtZW51LmFkZF9jb21tYW5kKGxhYmVsPSLnspjotLQiLCBjb21tYW5kPWxhbWJkYTogd2lkZ2V0LmV2ZW50X2dlbmVyYXRlKCc8PFBhc3RlPj4nKSkNCiAgICBtZW51LmFkZF9jb21tYW5kKGxhYmVsPSLliarliIciLCBjb21tYW5kPWxhbWJkYTogd2lkZ2V0LmV2ZW50X2dlbmVyYXRlKCc8PEN1dD4+JykpDQogICAgd2lkZ2V0LmJpbmQoIjxCdXR0b24tMz4iLCBsYW1iZGEgZXZlbnQ6IG1lbnUudGtfcG9wdXAoZXZlbnQueF9yb290LCBldmVudC55X3Jvb3QpKQ0KDQoNCg0KIyDliJvlu7rmj5DnpLrmoIfnrb4NCmxhYmVsID0gdGsuTGFiZWwocm9vdCwgdGV4dD0i5q+P6KGM6L6T5YWl5LiA5LiqSGFzaOWAvO+8jOWkmuS4qkhhc2jlgLzor7fmjaLooYzovpPlhaXvvJoiKQ0KbGFiZWwucGFjayhwYWR5PTUpDQoNCg0KIyDliJvlu7pJUOWGheWuuei+k+WFpeahhu+8iOWkmuihjO+8iQ0KIyBlbnRyeSA9IHRrLlRleHQocm9vdCwgd2lkdGg9ODAsIGhlaWdodD0xMikgICMg5aKe5aSn6L6T5YWl5qGG5aSn5bCPDQojIGVudHJ5LnBhY2socGFkeT0yMCkNCiMgY3JlYXRlX2NvbnRleHRfbWVudShlbnRyeSkNCicnJw0K5Luj56CB5LyY5YyW6K+05piODQrmt7vliqDmu5rliqjmnaE6DQrliJvlu7rkuIDkuKogdGV4dF9mcmFtZSDmoYbmnrbvvIzlsIYgZW50cnkg5ZKMIHNjcm9sbGJhciDmlL7nva7lhbbkuK3jgIINCuS9v+eUqCBlbnRyeS5wYWNrKHNpZGU9dGsuTEVGVCwgZmlsbD10ay5CT1RILCBleHBhbmQ9VHJ1ZSkg5ZKMIHNjcm9sbGJhci5wYWNrKHNpZGU9dGsuUklHSFQsIGZpbGw9dGsuWSkg5p2l5o6S5YiX6L6T5YWl5qGG5ZKM5rua5Yqo5p2h44CCDQrnu5Hlrprmu5rliqjmnaHlkozmlofmnKzovpPlhaXmoYbjgIINCg0K5biD5bGA6LCD5pW0Og0K5L2/55SoIHBsYWNlIOaWueazleadpeeyvuehruWumuS9jeaMiemSrueahOS9jee9ruOAgg0K5Y+W5raI5LiN5b+F6KaB55qEIHBhY2sg5pa55rOV77yM6YG/5YWN5Yay56qB44CCDQonJycNCiMg5Yib5bu6SVDlhoXlrrnovpPlhaXmoYbvvIjlpJrooYzvvInlubblop7liqDmu5rliqjmnaENCnRleHRfZnJhbWUgPSB0ay5GcmFtZShyb290KQ0KdGV4dF9mcmFtZS5wYWNrKHBhZHk9MjApDQoNCmVudHJ5ID0gdGsuVGV4dCh0ZXh0X2ZyYW1lLCB3aWR0aD04MCwgaGVpZ2h0PTE0KQ0KZW50cnkucGFjayhzaWRlPXRrLkxFRlQsIGZpbGw9dGsuQk9USCwgZXhwYW5kPVRydWUpDQoNCnNjcm9sbGJhciA9IHRrLlNjcm9sbGJhcih0ZXh0X2ZyYW1lLCBjb21tYW5kPWVudHJ5Lnl2aWV3KQ0Kc2Nyb2xsYmFyLnBhY2soc2lkZT10ay5SSUdIVCwgZmlsbD10ay5ZKQ0KDQplbnRyeS5jb25maWcoeXNjcm9sbGNvbW1hbmQ9c2Nyb2xsYmFyLnNldCkNCmNyZWF0ZV9jb250ZXh0X21lbnUoZW50cnkpDQoNCiMg5Yib5bu65pCc57Si5byV5pOO6YCJ6aG5DQojIG9wdGlvbnMgPSBbIuW+ruatpSIsICJWaXJ1c1RvdGFsIiwgIlZpclNjYW4iLCAiMzYwIiwgIuiFvuiuryJdDQpvcHRpb25zID0gWyLlvq7mraUiLCAiVmlydXNUb3RhbCIsICJWaXJTY2FuIiwgIuiFvuiuryJdDQpvcHRpb25fdmFycyA9IFtdDQoNCiPliJvlu7rkuIDkuKpGcmFtZeeUqOaIt+WxheS4reaYvuekuumAiemhuQ0KZnJhbWUgPSB0ay5GcmFtZShyb290KQ0KZnJhbWUucGFjaygpDQoNCmZvciBvcHQgaW4gb3B0aW9uczoNCiAgICB2YXIgPSB0ay5JbnRWYXIoKQ0KICAgIHZhci5zZXQoMCkNCiAgICBvcHRpb25fdmFycy5hcHBlbmQodmFyKQ0KICAgIGNoZWNrX2J1dHRvbiA9IHRrLkNoZWNrYnV0dG9uKGZyYW1lLCB0ZXh0PW9wdCwgdmFyaWFibGU9dmFyLCB3aWR0aD03LCBoZWlnaHQ9MiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSkNCiAgICBjaGVja19idXR0b24ucGFjayhzaWRlPXRrLkxFRlQpICMg5bGF5Lit5pi+56S6DQpmcmFtZS5wbGFjZShyZWx4PTAuNDgsIHJlbHk9MC41NSwgYW5jaG9yPXRrLkNFTlRFUiwpDQoNCiMg5Yib5bu65YWo6YCJ5oyJ6ZKuDQpzZWxlY3RfYWxsX3ZhciA9IHRrLkludFZhcigpDQpzZWxlY3RfYWxsX3Zhci5zZXQoMCkNCg0KZGVmIHNlbGVjdF9hbGwoKToNCiAgICBnbG9iYWwgb3B0aW9uX3ZhcnMNCiAgICBzZWxlY3RfdmFsdWUgPSBzZWxlY3RfYWxsX3Zhci5nZXQoKQ0KICAgIGZvciB2YXIgaW4gb3B0aW9uX3ZhcnM6DQogICAgICAgIHZhci5zZXQoc2VsZWN0X3ZhbHVlKQ0KDQpzZWxlY3RfYWxsX2J1dHRvbiA9IHRrLkNoZWNrYnV0dG9uKHJvb3QsIHRleHQ9IuWFqOmAiSIsIHZhcmlhYmxlPXNlbGVjdF9hbGxfdmFyLCBjb21tYW5kPXNlbGVjdF9hbGwsIHdpZHRoPTUsIGhlaWdodD0yLCBmb250PSgiSGVsdmV0aWNhIiwgMTIpKQ0Kc2VsZWN0X2FsbF9idXR0b24ucGxhY2UocmVseD0wLjc3LCByZWx5PTAuNTUsIGFuY2hvcj10ay5DRU5URVIpICAjIOiwg+aVtOWFqOmAieaMiemSruS9jee9rg0KDQoj5Yib5bu65LiA5Liq5riF56m66L6T5YWl5qGG55qE5oyJ6ZKuDQpkZWYgY2xlYXJfZW50cnkoKToNCiAgICBlbnRyeS5kZWxldGUoIjEuMCIsIHRrLkVORCkNCg0KIyDliJvlu7rmuIXnqbrovpPlhaXmoYbnmoTmjInpkq4NCmNsZWFyX2J1dHRvbiA9IHRrLkJ1dHRvbihyb290LCB0ZXh0PSLmuIXnqboiLCBjb21tYW5kPWNsZWFyX2VudHJ5LCB3aWR0aD0xMCwgaGVpZ2h0PTIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMikpDQpjbGVhcl9idXR0b24ucGFjayhwYWR5PTIwKQ0KY2xlYXJfYnV0dG9uLnBhY2soc2lkZT10ay5MRUZUKQ0KY2xlYXJfYnV0dG9uLnBsYWNlKHJlbHg9MC42NSwgcmVseT0wLjcsIGFuY2hvcj10ay5DRU5URVIpDQoNCiMg5LuOSGFzaENvbmZpZy50eHTmlofku7bkuK3or7vlj5botKblj7flkozlr4bnoIHkv6Hmga8NCmFjY291bnRzID0ge30NCnRyeToNCiAgICB3aXRoIG9wZW4oJ0hhc2hDb25maWcudHh0JywgJ3InKSBhcyBmaWxlOg0KICAgICAgICBmb3IgbGluZSBpbiBmaWxlOg0KICAgICAgICAgICAgZGF0YSA9IGxpbmUuc3RyaXAoKS5zcGxpdCgpDQogICAgICAgICAgICBpZiBsZW4oZGF0YSkgPT0gMzogICMg56Gu5L+d5q+P6KGM5pyJ5LiJ5Liq5YWD57SgDQogICAgICAgICAgICAgICAga2V5ID0gZGF0YVswXSAgIyDnrKzkuIDkuKrlhYPntKDkvZzkuLrplK4NCiAgICAgICAgICAgICAgICB2YWx1ZSA9IGRhdGFbMTpdICAjIOWJqeS4i+eahOWFg+e0oOS9nOS4uuWAvOeahOWIl+ihqA0KICAgICAgICAgICAgICAgIGFjY291bnRzW2tleV0gPSAnICcuam9pbih2YWx1ZSkgICMg5bCG5YC855qE5YiX6KGo5ZCI5bm25Li65LiA5Liq5a2X56ym5LiyDQpleGNlcHQgRmlsZU5vdEZvdW5kRXJyb3I6DQogICAgIyBtZXNzYWdlYm94LnNob3dpbmZvKCLmj5DnpLoiLCAi5Zyo5b2T5YmN5paH5Lu25aS55LiL5bey55Sf5oiQSGFzaENvbmZpZy50eHTphY3nva7mlofku7bvvIzor7fmjInnhafop4TojIPphY3nva7lkI7lho3ph43lkK/nqIvluo/nmbvlvZXvvIEiKQ0KICAgIHByaW50KCLmnKrmib7liLBIYXNoQ29uZmlnLnR4dOaWh+S7tiIpDQogICAgIyDliJvlu7rmlrDnmoRIYXNoQ29uZmlnLnR4dOaWh+S7tuW5tuWGmeWFpeWGheWuuQ0KICAgIHdpdGggb3BlbignSGFzaENvbmZpZy50eHQnLCAndycpIGFzIGZpbGU6DQogICAgICAgIGZpbGUud3JpdGUoIiPlvq7mraUgdXNlcjEyMyBwYXNzMTIzXG4iKQ0KICAgICAgICBmaWxlLndyaXRlKCIjVmlydXNUb3RhbCB1c2VyMTIzIHBhc3MxMjNcbiIpDQogICAgICAgIGZpbGUud3JpdGUoIiNWaXJTY2FuIHVzZXIxMjMgcGFzczEyM1xuIikNCiAgICAgICAgIyBmaWxlLndyaXRlKCIjMzYwIHVzZXIxMjMgcGFzczEyM1xuIikNCiAgICAgICAgZmlsZS53cml0ZSgiI+iFvuiuryB1c2VyMTIzIHBhc3MxMjNcbiIpDQogICAgICAgIGZpbGUud3JpdGUoIlxuIikNCiAgICAgICAgIyBmaWxlLndyaXRlKCIj6L+Z5Liq6YWN572u5paH5Lu25Li76KaB5piv57uZ6Ieq5Yqo55m75b2V6YWN572u55qE77yBXG4iKQ0KICAgICAgICBmaWxlLndyaXRlKCIj5L2/55So5pa55rOV77ya5oqKI+WOu+aOie+8jOabv+aNouWvueW6lOeahOi0puWPt+WSjOWvhueggeOAglxuIikNCiAgICAgICAgZmlsZS53cml0ZSgiI+eJueWIq+azqOaEj++8mui0puWPt+WJjemdoueahOWQjeensOS4jeiDveS/ruaUue+8gei0puWPt+WSjOWJjemdoueahOWQjeensOacieepuuagvO+8jOi0puWPt+WSjOWvhueggeS4remXtOS5n+acieepuuagvOOAglxuIikNCiMgcHJpbnQoYWNjb3VudHMpDQoNCg0KI+WIm+W7uuaJuemHj+eZu+W9leWHveaVsA0KZGVmIGxvZ2luKCk6DQogICAgc2VsZWN0ZWRfZW5naW5lcyA9IFtpIGZvciBpLCB2YXIgaW4gZW51bWVyYXRlKG9wdGlvbl92YXJzKSBpZiB2YXIuZ2V0KCkgPT0gMV0NCiAgICBpZiBub3Qgc2VsZWN0ZWRfZW5naW5lczoNCiAgICAgICAgbWVzc2FnZWJveC5zaG93ZXJyb3IoIumUmeivryIsICLor7fpgInmi6noh7PlsJHkuIDkuKrlqIHog4Hmg4XmiqXnmbvlvZUiKQ0KICAgICAgICByZXR1cm4NCiAgICBnbG9iYWwgZHJpdmVyDQogICAgdHJ5Og0KICAgICAgICAjIENoZWNrIGlmIHRoZSBkcml2ZXIgaXMgYWxyZWFkeSBjbG9zZWQgYW5kIHJlc3RhcnQgaWYgbmVjZXNzYXJ5DQogICAgICAgIGRyaXZlci50aXRsZQ0KICAgIGV4Y2VwdDoNCiAgICAgICAgc3RhcnRfYnJvd3NlcigpDQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKG9wdGlvbnMpKToNCiAgICAgICAgaWYgb3B0aW9uX3ZhcnNbaV0uZ2V0KCkgPT0gMToNCiAgICAgICAgICAgIGlmIGkgPT0gMDogICMg5b6u5q2lDQogICAgICAgICAgICAgICAgIyBwcmludCgi5b2T5YmN6YCJ6aG5OiIsIG9wdGlvbnNbaV0pDQogICAgICAgICAgICAgICAgc2VsZWN0ZWRfb3B0aW9uID0gb3B0aW9uc1tpXQ0KICAgICAgICAgICAgICAgIGlmIHNlbGVjdGVkX29wdGlvbiBpbiBhY2NvdW50czoNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IGFjY291bnRzW3NlbGVjdGVkX29wdGlvbl0uc3BsaXQoKQ0KICAgICAgICAgICAgICAgICAgICBpZiBsZW4oZGF0YSkgPT0gMjoNCiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBkYXRhWzBdDQogICAgICAgICAgICAgICAgICAgICAgICBwYXNzd29yZCA9IGRhdGFbMV0NCiAgICAgICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+35L+h5oGv5qC85byP6ZSZ6K+vOiB7c2VsZWN0ZWRfb3B0aW9ufSIpDQogICAgICAgICAgICAgICAgZWxzZToNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZWJveC5zaG93aW5mbygi6Ieq5Yqo5YyW55m75b2V5o+Q56S6IiwgZiLor7fphY3nva7lpb1IYXNoQ29uZmlnLnR4dOaWh+S7tuS4rXtzZWxlY3RlZF9vcHRpb25955qE6LSm5Y+35ZKM5a+G56CB77yM54S25ZCO6YeN5paw6L+Q6KGM56iL5bqP44CC56Gu5L+d6LSm5Y+35a+G56CB5aGr5YaZ6KeE6IyD44CCIikNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAjIOWBnOatouaJp+ihjOWQjue7reS7o+eggQ0KICAgICAgICAgICAgICAgIGRyaXZlci5leGVjdXRlX3NjcmlwdCgid2luZG93Lm9wZW4oJycpOyIpDQogICAgICAgICAgICAgICAgZHJpdmVyLnN3aXRjaF90by53aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWy0xXSkNCiAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KCdodHRwczovL3Bhc3Nwb3J0LnRocmVhdGJvb2suY24vbG9naW4/c2VydmljZT14JmNhbGxiYWNrVVJMPWh0dHBzOi8veC50aHJlYXRib29rLmNvbS92NS9ub2RlL2RiM2ZhZTdkMmRkMTRiZjAvODk2M2M3MGYyYjcxMDE5Yj9yZWRpcmVjdFVSTD1odHRwcyUyNTNBJTI1MkYlMjUyRngudGhyZWF0Ym9vay5jb20lMjUyRicpDQogICAgICAgICAgICAgICAgV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5lbGVtZW50X3RvX2JlX2NsaWNrYWJsZSgoQnkuWFBBVEgsICcvLypbQGlkPSJhcHAiXS9kaXYvZGl2L2RpdlsyXS9kaXYvZGl2WzJdL2RpdlsxXS9kaXYvZGl2WzNdL2RpdlsyXScpKSkuY2xpY2soKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0iYXBwIl0vZGl2L2Rpdi9kaXZbMl0vZGl2L2RpdlsyXS9kaXZbMV0vZGl2L2Rpdls0XS9kaXYvbGFiZWwvc3BhbicpKSkuY2xpY2soKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0icGhvbmVPckVtYWlsIl0nKSkpLnNlbmRfa2V5cyhuYW1lKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0icGFzc3dvcmQiXScpKSkuc2VuZF9rZXlzKHBhc3N3b3JkKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAyMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0iYXBwIl0vZGl2L2Rpdi9kaXZbMl0vZGl2L2RpdlsyXS9kaXZbMV0vZGl2L2Rpdls0XS9mb3JtL2RpdlszXS9kaXYvaW5wdXQnKSkpLmNsaWNrKCkNCiAgICAgICAgICAgIGVsaWYgaSA9PSAxOiAgICAjIFZpcnVzVG90YWwNCiAgICAgICAgICAgICAgICAjIHByaW50KCLlvZPliY3pgInpobk6Iiwgb3B0aW9uc1tpXSkNCiAgICAgICAgICAgICAgICBzZWxlY3RlZF9vcHRpb24gPSBvcHRpb25zW2ldDQogICAgICAgICAgICAgICAgaWYgc2VsZWN0ZWRfb3B0aW9uIGluIGFjY291bnRzOg0KICAgICAgICAgICAgICAgICAgICBkYXRhID0gYWNjb3VudHNbc2VsZWN0ZWRfb3B0aW9uXS5zcGxpdCgpDQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihkYXRhKSA9PSAyOg0KICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGRhdGFbMF0NCiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3N3b3JkID0gZGF0YVsxXQ0KICAgICAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZiLotKblj7fkv6Hmga/moLzlvI/plJnor686IHtzZWxlY3RlZF9vcHRpb259IikNCiAgICAgICAgICAgICAgICBlbHNlOg0KICAgICAgICAgICAgICAgICAgICBtZXNzYWdlYm94LnNob3dpbmZvKCLoh6rliqjljJbnmbvlvZXmj5DnpLoiLCBmIuivt+mFjee9ruWlvWNvbmZpZy50eHTmlofku7bkuK17c2VsZWN0ZWRfb3B0aW9ufeeahOi0puWPt+WSjOWvhuegge+8jOeEtuWQjumHjeaWsOi/kOihjOeoi+W6j+OAguehruS/nei0puWPt+WvhueggeWhq+WGmeinhOiMg+OAgiIpDQogICAgICAgICAgICAgICAgICAgIHJldHVybiAgIyDlgZzmraLmiafooYzlkI7nu63ku6PnoIENCiAgICAgICAgICAgICAgICBkcml2ZXIuZXhlY3V0ZV9zY3JpcHQoIndpbmRvdy5vcGVuKCcnKTsiKQ0KICAgICAgICAgICAgICAgIGRyaXZlci5zd2l0Y2hfdG8ud2luZG93KGRyaXZlci53aW5kb3dfaGFuZGxlc1stMV0pDQogICAgICAgICAgICAgICAgZHJpdmVyLmdldCgnaHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL3NpZ24taW4nKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0idXNlcklkIl0nKSkpLnNlbmRfa2V5cyhuYW1lKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0icGFzc3dvcmQiXScpKSkuc2VuZF9rZXlzKHBhc3N3b3JkKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0ic2lnbi1pbi1idG4iXScpKSkuY2xpY2soKQ0KICAgICAgICAgICAgZWxpZiBpID09IDI6ICAgICMgVmlyU2Nhbg0KICAgICAgICAgICAgICAgICMgcHJpbnQoIuW9k+WJjemAiemhuToiLCBvcHRpb25zW2ldKQ0KICAgICAgICAgICAgICAgIHNlbGVjdGVkX29wdGlvbiA9IG9wdGlvbnNbaV0NCiAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9vcHRpb24gaW4gYWNjb3VudHM6DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhY2NvdW50c1tzZWxlY3RlZF9vcHRpb25dLnNwbGl0KCkNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGRhdGEpID09IDI6DQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gZGF0YVswXQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQgPSBkYXRhWzFdDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIui0puWPt+S/oeaBr+agvOW8j+mUmeivrzoge3NlbGVjdGVkX29wdGlvbn0iKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIuiHquWKqOWMlueZu+W9leaPkOekuiIsIGYi6K+36YWN572u5aW9Y29uZmlnLnR4dOaWh+S7tuS4rXtzZWxlY3RlZF9vcHRpb25955qE6LSm5Y+35ZKM5a+G56CB77yM54S25ZCO6YeN5paw6L+Q6KGM56iL5bqP44CC56Gu5L+d6LSm5Y+35a+G56CB5aGr5YaZ6KeE6IyD44CCIikNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAjIOWBnOatouaJp+ihjOWQjue7reS7o+eggQ0KICAgICAgICAgICAgICAgIGRyaXZlci5leGVjdXRlX3NjcmlwdCgid2luZG93Lm9wZW4oJycpOyIpDQogICAgICAgICAgICAgICAgZHJpdmVyLnN3aXRjaF90by53aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWy0xXSkNCiAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KCdodHRwczovL3d3dy52aXJzY2FuLm9yZy9sb2dpbj9jYWxsYmFja1VSTD0lMkYnKQ0KICAgICAgICAgICAgICAgICNXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwnLy8qW0BpZD0ibG9naW4tY29udGVudCJdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXYvZGl2WzJdL2Zvcm0vZGl2WzVdL2Rpdi9sYWJlbC9pbnB1dCcpKSkuY2xpY2soKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCcvLypbQGlkPSJsYXlvdXQiXS9tYWluL2Rpdi9kaXZbMl0vZGl2WzJdL2RpdlsyXS9mb3JtL2RpdlsxXS9kaXZbMV0vaW5wdXQnKSkpLnNlbmRfa2V5cyhuYW1lKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCcvLypbQGlkPSJsYXlvdXQiXS9tYWluL2Rpdi9kaXZbMl0vZGl2WzJdL2RpdlsyXS9mb3JtL2RpdlsyXS9kaXZbMV0vaW5wdXQnKSkpLnNlbmRfa2V5cyhwYXNzd29yZCkNCiAgICAgICAgICAgICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwnLy8qW0BpZD0ibGF5b3V0Il0vbWFpbi9kaXYvZGl2WzJdL2RpdlsyXS9kaXZbMl0vZm9ybS9idXR0b24nKSkpLmNsaWNrKCkNCiAgICAgICAgICAgICMgZWxpZiBpID09IDM6ICAgICMgMzYwDQogICAgICAgICAgICAjICAgICAjIHByaW50KCLlvZPliY3pgInpobk6Iiwgb3B0aW9uc1tpXSkNCiAgICAgICAgICAgICMgICAgIHNlbGVjdGVkX29wdGlvbiA9IG9wdGlvbnNbaV0NCiAgICAgICAgICAgICMgICAgIGlmIHNlbGVjdGVkX29wdGlvbiBpbiBhY2NvdW50czoNCiAgICAgICAgICAgICMgICAgICAgICBkYXRhID0gYWNjb3VudHNbc2VsZWN0ZWRfb3B0aW9uXS5zcGxpdCgpDQogICAgICAgICAgICAjICAgICAgICAgaWYgbGVuKGRhdGEpID09IDI6DQogICAgICAgICAgICAjICAgICAgICAgICAgIG5hbWUgPSBkYXRhWzBdDQogICAgICAgICAgICAjICAgICAgICAgICAgIHBhc3N3b3JkID0gZGF0YVsxXQ0KICAgICAgICAgICAgIyAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAjICAgICAgICAgICAgIHByaW50KGYi6LSm5Y+35L+h5oGv5qC85byP6ZSZ6K+vOiB7c2VsZWN0ZWRfb3B0aW9ufSIpDQogICAgICAgICAgICAjICAgICBlbHNlOg0KICAgICAgICAgICAgIyAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIuiHquWKqOWMlueZu+W9leaPkOekuiIsIGYi6K+36YWN572u5aW9Y29uZmlnLnR4dOaWh+S7tuS4rXtzZWxlY3RlZF9vcHRpb25955qE6LSm5Y+35ZKM5a+G56CB77yM54S25ZCO6YeN5paw6L+Q6KGM56iL5bqP44CC56Gu5L+d6LSm5Y+35a+G56CB5aGr5YaZ6KeE6IyD44CCIikNCiAgICAgICAgICAgICMgICAgICAgICByZXR1cm4gICMg5YGc5q2i5omn6KGM5ZCO57ut5Luj56CBDQogICAgICAgICAgICAjICAgICBkcml2ZXIuZXhlY3V0ZV9zY3JpcHQoIndpbmRvdy5vcGVuKCcnKTsiKQ0KICAgICAgICAgICAgIyAgICAgZHJpdmVyLnN3aXRjaF90by53aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWy0xXSkNCiAgICAgICAgICAgICMgICAgIGRyaXZlci5nZXQoJ2h0dHBzOi8vdGkuMzYwLm5ldC9sb2dpbj9yZWRpcmVjdFVybD1odHRwcyUyNTNBJTI1MkYlMjUyRnRpLjM2MC5uZXQlMjUyRicpDQogICAgICAgICAgICAjICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwgJy8vKltAaWQ9ImxvZ2luLWNvbnRlbnQiXS9kaXYvZGl2WzFdL2Rpdi9kaXYvZGl2L2RpdlsyXS9hJykpKS5jbGljaygpDQogICAgICAgICAgICAjICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwgJy8vKltAaWQ9ImxvZ2luLWNvbnRlbnQiXS9kaXYvZGl2WzJdL2Rpdi9kaXYvZGl2L2RpdlsyXS9mb3JtL2RpdlsxXS9kaXYvZGl2L2lucHV0JykpKS5zZW5kX2tleXMobmFtZSkNCiAgICAgICAgICAgICMgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0ibG9naW4tY29udGVudCJdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXYvZGl2WzJdL2Zvcm0vZGl2WzJdL2Rpdi9kaXYvaW5wdXQnKSkpLnNlbmRfa2V5cyhwYXNzd29yZCkNCiAgICAgICAgICAgICMgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0ibG9naW4tY29udGVudCJdL2Rpdi9kaXZbMl0vZGl2L2Rpdi9kaXYvZGl2WzJdL2Zvcm0vZGl2WzVdL2Rpdi9sYWJlbC9pbnB1dCcpKSkuY2xpY2soKQ0KICAgICAgICAgICAgIyAgICAgV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5lbGVtZW50X3RvX2JlX2NsaWNrYWJsZSgoQnkuWFBBVEgsICcvLypbQGlkPSJsb2dpbi1jb250ZW50Il0vZGl2L2RpdlsyXS9kaXYvZGl2L2Rpdi9kaXZbMl0vZm9ybS9kaXZbNl0vaW5wdXQnKSkpLmNsaWNrKCkNCiAgICAgICAgICAgIGVsaWYgaSA9PSAzOiAgICAjIOiFvuiurw0KICAgICAgICAgICAgICAgICMgcHJpbnQoIuW9k+WJjemAiemhuToiLCBvcHRpb25zW2ldKQ0KICAgICAgICAgICAgICAgIHNlbGVjdGVkX29wdGlvbiA9IG9wdGlvbnNbaV0NCiAgICAgICAgICAgICAgICBpZiBzZWxlY3RlZF9vcHRpb24gaW4gYWNjb3VudHM6DQogICAgICAgICAgICAgICAgICAgIGRhdGEgPSBhY2NvdW50c1tzZWxlY3RlZF9vcHRpb25dLnNwbGl0KCkNCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKGRhdGEpID09IDI6DQogICAgICAgICAgICAgICAgICAgICAgICBuYW1lID0gZGF0YVswXQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGFzc3dvcmQgPSBkYXRhWzFdDQogICAgICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmIui0puWPt+S/oeaBr+agvOW8j+mUmeivrzoge3NlbGVjdGVkX29wdGlvbn0iKQ0KICAgICAgICAgICAgICAgIGVsc2U6DQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2Vib3guc2hvd2luZm8oIuiHquWKqOWMlueZu+W9leaPkOekuiIsIGYi6K+36YWN572u5aW9Y29uZmlnLnR4dOaWh+S7tuS4rXtzZWxlY3RlZF9vcHRpb25955qE6LSm5Y+35ZKM5a+G56CB77yM54S25ZCO6YeN5paw6L+Q6KGM56iL5bqP44CC56Gu5L+d6LSm5Y+35a+G56CB5aGr5YaZ6KeE6IyD44CCIikNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICAjIOWBnOatouaJp+ihjOWQjue7reS7o+eggQ0KICAgICAgICAgICAgICAgIGRyaXZlci5leGVjdXRlX3NjcmlwdCgid2luZG93Lm9wZW4oJycpOyIpDQogICAgICAgICAgICAgICAgZHJpdmVyLnN3aXRjaF90by53aW5kb3coZHJpdmVyLndpbmRvd19oYW5kbGVzWy0xXSkNCiAgICAgICAgICAgICAgICBkcml2ZXIuZ2V0KCdodHRwczovL2hhYm8ucXEuY29tLycpDQogICAgICAgICAgICAgICAgI+eCueWHu+eZu+W9leaMiemSrg0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LklELCAnbm9sb2dpbicpKSkuY2xpY2soKQ0KICAgICAgICAgICAgICAgICPnrYnlvoXnrKzkuIDkuKppZnJhbWXliqDovb3lrozmiJANCiAgICAgICAgICAgICAgICBpZnJhbWUgPSBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLnByZXNlbmNlX29mX2VsZW1lbnRfbG9jYXRlZCgoQnkuSUQsICdsb2dpbl9pZnInKSkpDQogICAgICAgICAgICAgICAgZHJpdmVyLnN3aXRjaF90by5mcmFtZShpZnJhbWUpDQogICAgICAgICAgICAgICAgI+etieW+heesrOS6jOS4qmlmcmFtZeWKoOi9veWujOaIkA0KICAgICAgICAgICAgICAgIGlmcmFtZSA9IFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMucHJlc2VuY2Vfb2ZfZWxlbWVudF9sb2NhdGVkKChCeS5JRCwgJ3B0bG9naW5faWZyYW1lJykpKQ0KICAgICAgICAgICAgICAgIGRyaXZlci5zd2l0Y2hfdG8uZnJhbWUoaWZyYW1lKQ0KICAgICAgICAgICAgICAgICPliIfmjaLmiJDotKblj7flr4bnoIHnmbvlvZUNCiAgICAgICAgICAgICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5JRCwgJ3N3aXRjaGVyX3Bsb2dpbicpKSkuY2xpY2soKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0idSJdJykpKS5zZW5kX2tleXMobmFtZSkNCiAgICAgICAgICAgICAgICBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwgJy8vKltAaWQ9InAiXScpKSkuc2VuZF9rZXlzKHBhc3N3b3JkKQ0KICAgICAgICAgICAgICAgIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0ibG9naW5fYnV0dG9uIl0nKSkpLmNsaWNrKCkNCg0KICAgICAgICAgICAgICAgICMgbm9sb2dpbl9saW5rID0gV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5lbGVtZW50X3RvX2JlX2NsaWNrYWJsZSgoQnkuSUQsICdub2xvZ2luJykpKQ0KICAgICAgICAgICAgICAgICMgbm9sb2dpbl9saW5rLmNsaWNrKCkNCiAgICAgICAgICAgICAgICAjICMg562J5b6F56ys5LiA5LiqaWZyYW1l5Yqg6L295a6M5oiQDQogICAgICAgICAgICAgICAgIyBpZnJhbWUxID0gV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5wcmVzZW5jZV9vZl9lbGVtZW50X2xvY2F0ZWQoKEJ5LklELCAnbG9naW5faWZyJykpKQ0KICAgICAgICAgICAgICAgICMgcHJpbnQoIkZpcnN0IGlmcmFtZSBmb3VuZCwgc3dpdGNoaW5nIHRvIGlmcmFtZS4iKQ0KICAgICAgICAgICAgICAgICMgZHJpdmVyLnN3aXRjaF90by5mcmFtZShpZnJhbWUxKQ0KICAgICAgICAgICAgICAgICMNCiAgICAgICAgICAgICAgICAjICMg562J5b6F56ys5LqM5LiqaWZyYW1l5Yqg6L295a6M5oiQDQogICAgICAgICAgICAgICAgIyBpZnJhbWUyID0gV2ViRHJpdmVyV2FpdChkcml2ZXIsIDEwKS51bnRpbChFQy5wcmVzZW5jZV9vZl9lbGVtZW50X2xvY2F0ZWQoKEJ5LklELCAncHRsb2dpbl9pZnJhbWUnKSkpDQogICAgICAgICAgICAgICAgIyBwcmludCgiU2Vjb25kIGlmcmFtZSBmb3VuZCwgc3dpdGNoaW5nIHRvIHRoZSBzZWNvbmQgaWZyYW1lLiIpDQogICAgICAgICAgICAgICAgIyBkcml2ZXIuc3dpdGNoX3RvLmZyYW1lKGlmcmFtZTIpDQogICAgICAgICAgICAgICAgIw0KICAgICAgICAgICAgICAgICMgIyDnrYnlvoVzd2l0Y2hlcl9wbG9naW7lhYPntKDlj6/ngrnlh7sNCiAgICAgICAgICAgICAgICAjIHN3aXRjaGVyX3Bsb2dpbiA9IFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LklELCAnc3dpdGNoZXJfcGxvZ2luJykpKQ0KICAgICAgICAgICAgICAgICMgcHJpbnQoIlN3aXRjaGVyX3Bsb2dpbiBmb3VuZCwgY2xpY2tpbmcgb24gaXQuIikNCiAgICAgICAgICAgICAgICAjIHN3aXRjaGVyX3Bsb2dpbi5jbGljaygpDQoNCiAgICAgICAgICAgICAgICAjIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0idSJdJykpKS5zZW5kX2tleXMobmFtZSkNCiAgICAgICAgICAgICAgICAjIFdlYkRyaXZlcldhaXQoZHJpdmVyLCAxMCkudW50aWwoRUMuZWxlbWVudF90b19iZV9jbGlja2FibGUoKEJ5LlhQQVRILCAnLy8qW0BpZD0icCJdJykpKS5zZW5kX2tleXMocGFzc3dvcmQpDQogICAgICAgICAgICAgICAgIyBXZWJEcml2ZXJXYWl0KGRyaXZlciwgMTApLnVudGlsKEVDLmVsZW1lbnRfdG9fYmVfY2xpY2thYmxlKChCeS5YUEFUSCwgJy8vKltAaWQ9ImxvZ2luX2J1dHRvbiJdJykpKS5jbGljaygpDQoNCg0KDQoj5ZyoVEvnlYzpnaLliJvlu7rkuIDkuKrnmbvlvZXmjInpkq4NCmxvZ2luX2J1dHRvbiA9IHRrLkJ1dHRvbihyb290LCB0ZXh0PSLnmbvlvZUiLCBjb21tYW5kPWxvZ2luLCB3aWR0aD0xMCwgaGVpZ2h0PTIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMikpDQpsb2dpbl9idXR0b24ucGFjayhwYWR5PTIwKQ0KbG9naW5fYnV0dG9uLnBhY2soc2lkZT10ay5MRUZUKQ0KbG9naW5fYnV0dG9uLnBsYWNlKHJlbHg9MC4zNSwgcmVseT0wLjcsIGFuY2hvcj10ay5DRU5URVIpDQoNCiMg5Yib5bu65p+l6K+i5oyJ6ZKuDQojIHNlYXJjaF9idXR0b24gPSB0ay5CdXR0b24ocm9vdCwgdGV4dD0i5p+l6K+iIiwgY29tbWFuZD1zZWFyY2gsIHdpZHRoPTEwLCBoZWlnaHQ9MiwgZm9udD0oIkhlbHZldGljYSIsIDEyKSkNCiMgc2VhcmNoX2J1dHRvbi5wbGFjZShyZWx4PTAuNSwgcmVseT0wLjYsIGFuY2hvcj10ay5DRU5URVIpDQpzZWFyY2hfYnV0dG9uID0gdGsuQnV0dG9uKHJvb3QsIHRleHQ9IuafpeivoiIsIGNvbW1hbmQ9c2VhcmNoLCB3aWR0aD0xMCwgaGVpZ2h0PTIsIGZvbnQ9KCJIZWx2ZXRpY2EiLCAxMikpDQpzZWFyY2hfYnV0dG9uLnBhY2socGFkeT0yMCkNCnNlYXJjaF9idXR0b24ucGFjayhzaWRlPXRrLkxFRlQpDQpzZWFyY2hfYnV0dG9uLnBsYWNlKHJlbHg9MC41LCByZWx5PTAuNywgYW5jaG9yPXRrLkNFTlRFUikNCg0KIyDnu5Hlrprnqpflj6PlhbPpl63kuovku7YNCnJvb3QucHJvdG9jb2woIldNX0RFTEVURV9XSU5ET1ciLCBvbl9jbG9zaW5nKQ0KDQojIOi/kOihjHRraW50ZXLnqpflj6MNCnJvb3QubWFpbmxvb3AoKQ